# Polymarket Copy Trading Bot

An automated **copy-trading bot for Polymarket** that mirrors trades from selected wallets in near real-time.

> **Disclaimer:** This project is for educational purposes. Prediction-market trading involves risk. Never trade with money you can’t afford to lose.

---

## Table of Contents

- [Features](#features)
- [Requirements](#requirements)
- [Installation](#installation)
- [Configuration](#configuration)
  - [Step 1: Run the Setup Wizard](#step-1-run-the-setup-wizard)
  - [Step 2: Configure Traders to Follow](#step-2-configure-traders-to-follow)
  - [Environment Variables (.env)](#environment-variables-env)
- [Usage](#usage)
- [Project Structure](#project-structure)
- [Authentication Overview](#authentication-overview)
- [Polymarket APIs](#polymarket-apis)
- [Risks & Safety Notes](#risks--safety-notes)
- [Troubleshooting](#troubleshooting)
- [Logs](#logs)
- [Workflow](#workflow)
- [Contributing](#contributing)
- [License](#license)
- [Resources](#resources)

---

## Features

- **Multi-trader tracking**: Monitor multiple traders from a JSON config file
- **Flexible copy sizing**: Copy using a fixed USDC amount or a percentage of the original trade
- **Order types**: Supports **FOK** (Fill or Kill) and **FAK** (market/Fill and Kill)
- **L2 authentication**: EIP-712 signing flow for secure trading
- **Real-time monitoring**: Copies **only new trades** (after bot startup)
- **Granular controls**: Per-trader toggles for buys/sells, position limits, and notes
- **Guided setup**: Setup wizard that derives and stores API credentials automatically

---

## Requirements

- **Python 3.9+**
- A **Polymarket account** funded with **USDC on Polygon**
- Your **Polymarket proxy wallet address** (“portfolio address”) and **private key**
- Basic CLI knowledge (PowerShell / Terminal)

---

## Installation

```bash
cd polymarket-copy-bot
pip install -r requirements.txt
```

**Recommended (virtual environment):**
```bash
python -m venv venv
# Windows (PowerShell)
.\venv\Scripts\Activate.ps1
# macOS/Linux
source venv/bin/activate

pip install -r requirements.txt
```

---

## Configuration

### Step 1: Run the Setup Wizard

```bash
python setup.py
```

The wizard will prompt you for:

1. **Private Key**: Your wallet private key (with or without `0x`)
2. **Proxy Address**: Your Polymarket proxy wallet address (the one shown in your portfolio)
3. **Signature Type**
   - `1` = Email/Google login (most common)
   - `0` = Standard EOA / MetaMask
   - `2` = Gnosis Safe
4. **Copy-trading settings**: fixed amount, percentage, order type, limits, etc.

What setup does automatically:

- ✓ Validates your credentials
- ✓ Derives Polymarket API keys
- ✓ Saves everything to `.env`
- ✓ Verifies connectivity

---

### Step 2: Configure Traders to Follow

Edit `config/traders.json`:

```json
{
  "traders": [
    {
      "address": "0xTRADER_WALLET_ADDRESS",
      "nickname": "ProTrader",
      "enabled": true,
      "copy_buys": true,
      "copy_sells": true,
      "max_position_size": 500,
      "notes": "High performer in political markets"
    }
  ]
}
```

**How to find traders to follow:**
1. Open the Polymarket Leaderboard: https://polymarket.com/leaderboard  
2. Sort by **Profit** or **Volume**
3. Click a trader profile and copy the wallet address from the URL/profile

---

### Environment Variables (.env)

`setup.py` generates a `.env` file similar to:

```env
# === WALLET CREDENTIALS ===
PRIVATE_KEY=0x...

# Your Polymarket proxy wallet address
FUNDER_ADDRESS=0x...

# Signature type: 0=EOA, 1=POLY_PROXY, 2=GNOSIS_SAFE
SIGNATURE_TYPE=2

# === API CREDENTIALS (AUTO-GENERATED) ===
POLY_API_KEY=...
POLY_API_SECRET=...
POLY_API_PASSPHRASE=...

# === COPY TRADING SETTINGS ===
AMOUNT_TO_COPY=50          # Fixed USDC amount per trade
COPY_SELL=true             # Whether to copy sells
PERCENTAGE_TO_COPY=100     # % of original trade size (or "null" to disable)
TYPE_ORDER=FOK             # FOK or FAK
MIN_TRADE_SIZE=10          # Minimum USDC per copied trade
MAX_TRADE_SIZE=1000        # Maximum USDC per copied trade
POLL_INTERVAL=5            # Seconds between checks
```

**Important security note:** never commit `.env` to Git. Add this to `.gitignore`:

```gitignore
.env
credentials.json
logs/
__pycache__/
*.pyc
```

---

## Usage

### Dry-run mode (recommended first)

```bash
python main.py --dry-run
```

### Normal mode

```bash
python main.py
```

### Common options

```bash
# Copy a fixed $100 per trade
python main.py --amount 100

# Copy 50% of the original trade size
python main.py --percentage 50

# Use market-style orders (FAK)
python main.py --order-type FAK

# More verbose logging
python main.py --log-level DEBUG
```

---

## Project Structure

```
polymarket-copy-bot/
├── setup.py                # Setup wizard (run first)
├── main.py                 # Main entry point
├── requirements.txt        # Python dependencies
├── .env                    # Configuration (generated by setup.py)
├── config/
│   └── traders.json        # Traders to follow
├── src/
│   ├── auth.py             # L1/L2 auth utilities
│   ├── trader_monitor.py   # Monitors trader activity
│   ├── order_executor.py   # Places/executes orders
│   ├── websocket_client.py # WebSocket client (if enabled)
│   └── utils.py            # Helpers / utilities
└── logs/                   # Log files
```

---

## Authentication Overview

The bot uses a two-layer flow:

### Layer 1 (L1) — Private Key
- Used to prove wallet ownership and derive API credentials
- Signs an **EIP-712** message
- Generated credentials are stored locally (e.g. `.env`, `credentials.json`)

### Layer 2 (L2) — API Credentials
- **HMAC-SHA256** credentials: `apiKey`, `secret`, `passphrase`
- Used for most API requests
- The private key may still be needed to sign orders depending on your setup

---

## Polymarket APIs

| API | Base URL | Purpose |
|---|---|---|
| **Gamma API** | `https://gamma-api.polymarket.com` | Market metadata |
| **CLOB API** | `https://clob.polymarket.com` | Trading & order book |
| **Data API** | `https://data-api.polymarket.com` | User activity & events |

---

## Risks & Safety Notes

1. **Financial risk:** Copy trading can lose money.
2. **Private key security:** Never share your private key. Never upload `.env` to GitHub.
3. **Latency & slippage:** There may be delay between the original trade and your copy.
4. **Production use:** Always start with `--dry-run`, then use small sizes and strict limits.

---

## Troubleshooting

### Error: `Could not create/derive api key`
- Confirm `PRIVATE_KEY` is correct
- Ensure `FUNDER_ADDRESS` is your **Polymarket proxy wallet address**
- Verify `SIGNATURE_TYPE` (commonly `1` for Email/Google accounts)

### Error: `Invalid signature`
- Usually caused by a wrong `SIGNATURE_TYPE`
- Try `SIGNATURE_TYPE=1` if your account uses Email/Google login

### Error: `Insufficient balance`
- Your proxy wallet needs enough **USDC on Polygon**

### Bot is detecting old trades
- The bot should only copy trades **after it starts**
- Existing trades are marked as “seen” during initialization

### No new trades detected
- Confirm `enabled: true` in `config/traders.json`
- Confirm the trader wallet has recent activity
- Increase `POLL_INTERVAL` only if rate limiting occurs (otherwise keep it low)

---

## Logs

```bash
# Follow logs in real time
tail -f logs/bot.log

# Run with debug logging
python main.py --log-level DEBUG
```

---

## Workflow

```
1) Run setup.py       → Generates .env with credentials
2) Edit traders.json  → Add/enable traders to follow
3) Run dry-run        → python main.py --dry-run
4) Run live           → python main.py
   ├─ Bot marks existing trades as "seen"
   ├─ Loop: poll Data API every X seconds
   ├─ Detect new trades (timestamp > bot start)
   ├─ Compute copy size (fixed or %)
   └─ Execute order (if rules allow)
```

---

## Contributing

1. Fork the repository
2. Create a feature branch
3. Open a pull request with a clear description

---

## License

MIT License

---

## Resources

- Polymarket Docs: https://docs.polymarket.com/
- py-clob-client (Python SDK): https://github.com/Polymarket/py-clob-client
- Polymarket Discord: https://discord.gg/polymarket
